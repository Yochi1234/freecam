local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- GUI
local gui = player:WaitForChild("PlayerGui"):WaitForChild("AstralGUI")
local toggleBtn = gui:WaitForChild("ToggleButton")
local controls = gui:WaitForChild("ControlFrame")

-- ปุ่มควบคุม
local btnUp = controls:WaitForChild("Up")
local btnDown = controls:WaitForChild("Down")
local btnLeft = controls:WaitForChild("Left")
local btnRight = controls:WaitForChild("Right")
local btnForward = controls:WaitForChild("Forward")
local btnBack = controls:WaitForChild("Back")

-- สถานะ
local isAstral = false
local moveDirection = Vector3.new()
local speed = 1

-- ปรับกล้อง
local function toggleAstral()
	isAstral = not isAstral
	if isAstral then
		camera.CameraType = Enum.CameraType.Scriptable
		camera.CFrame = player.Character.Head.CFrame + Vector3.new(0, 5, 0)
		controls.Visible = true
	else
		camera.CameraType = Enum.CameraType.Custom
		controls.Visible = false
	end
end

-- ผูกปุ่ม
toggleBtn.MouseButton1Click:Connect(toggleAstral)

-- ปุ่มกดค้างเคลื่อนกล้อง
local btnMap = {
	[btnForward] = Vector3.new(0, 0, -1),
	[btnBack] = Vector3.new(0, 0, 1),
	[btnLeft] = Vector3.new(-1, 0, 0),
	[btnRight] = Vector3.new(1, 0, 0),
	[btnUp] = Vector3.new(0, 1, 0),
	[btnDown] = Vector3.new(0, -1, 0),
}

for button, dir in pairs(btnMap) do
	local holding = false

	button.MouseButton1Down:Connect(function()
		holding = true
		while holding and isAstral do
			moveDirection += dir
			wait(0.05)
		end
	end)

	button.MouseButton1Up:Connect(function()
		moveDirection = Vector3.new()
		holding = false
	end)
end

-- เคลื่อนกล้องทุกเฟรม
RunService.RenderStepped:Connect(function()
	if isAstral and moveDirection.Magnitude > 0 then
		camera.CFrame = camera.CFrame + camera.CFrame:VectorToWorldSpace(moveDirection.Unit * speed)
	end
end)
