-- [ LocalScript in StarterPlayerScripts ]
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- Create GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AstralGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Toggle Button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Name = "ToggleButton"
toggleBtn.Size = UDim2.new(0, 120, 0, 50)
toggleBtn.Position = UDim2.new(0, 10, 1, -60)
toggleBtn.Text = "ถอดจิต"
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
toggleBtn.TextScaled = true
toggleBtn.Parent = screenGui

-- Control Frame
local controlFrame = Instance.new("Frame")
controlFrame.Name = "ControlFrame"
controlFrame.Size = UDim2.new(0, 200, 0, 200)
controlFrame.Position = UDim2.new(1, -220, 1, -220)
controlFrame.BackgroundTransparency = 0.4
controlFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
controlFrame.Visible = false
controlFrame.Parent = screenGui

local directions = {
	{"Forward", "↑", Vector3.new(0, 0, -1), UDim2.new(0.5, -25, 0, 0)},
	{"Back", "↓", Vector3.new(0, 0, 1), UDim2.new(0.5, -25, 0, 100)},
	{"Left", "←", Vector3.new(-1, 0, 0), UDim2.new(0, 0, 0, 50)},
	{"Right", "→", Vector3.new(1, 0, 0), UDim2.new(0, 100, 0, 50)},
	{"Up", "⇧", Vector3.new(0, 1, 0), UDim2.new(0, 0, 0, 0)},
	{"Down", "⇩", Vector3.new(0, -1, 0), UDim2.new(0, 100, 0, 0)},
}

local buttons = {}
for _, info in ipairs(directions) do
	local btn = Instance.new("TextButton")
	btn.Name = info[1]
	btn.Text = info[2]
	btn.Size = UDim2.new(0, 50, 0, 50)
	btn.Position = info[4]
	btn.TextScaled = true
	btn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
	btn.Parent = controlFrame
	buttons[btn] = info[3]
end

-- Logic
local isAstral = false
local moveDirection = Vector3.new()
local speed = 1

-- Toggle Astral View
toggleBtn.MouseButton1Click:Connect(function()
	isAstral = not isAstral
	if isAstral then
		camera.CameraType = Enum.CameraType.Scriptable
		camera.CFrame = player.Character.Head.CFrame + Vector3.new(0, 5, 0)
		controlFrame.Visible = true
	else
		camera.CameraType = Enum.CameraType.Custom
		controlFrame.Visible = false
	end
end)

-- Movement per button
for btn, dir in pairs(buttons) do
	local holding = false
	btn.MouseButton1Down:Connect(function()
		holding = true
		while holding and isAstral do
			moveDirection = dir
			wait(0.05)
		end
	end)
	btn.MouseButton1Up:Connect(function()
		holding = false
		moveDirection = Vector3.new()
	end)
end

-- Move camera each frame
RunService.RenderStepped:Connect(function()
	if isAstral and moveDirection.Magnitude > 0 then
		camera.CFrame = camera.CFrame + camera.CFrame:VectorToWorldSpace(moveDirection.Unit * speed)
	end
end)
